<p>Measuring the environmental impact of digital: Why estimate carbon emissions (quantity of CO₂e emissions)?</p>

<ul>
  <li>Refine practices by using figures to determine whether an investment in a project is justified.</li>
  <li>Provide figures to CSR departments responsible for producing an annual CSR report.</li>
  <li>Objectively assess the impact of IT to facilitate dialogue on the subject.
Or simply because, as Niels Bohr put it, “Nothing exists until it is measured”.</li>
</ul>

<p>These reasons are relevant to every digital project. Assessing CO2 emissions for GENAI projects raises questions such as: how much CO2 equivalent did a generative model consume to be used? What is the environmental cost of sending an e-mail generated by a GenAI model? How can the carbon footprint of models be reduced?</p>

<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="green"><mi>T</mi><mi>h</mi><mi>e</mi><mtext> </mtext><mi>m</mi><mi>a</mi><mi>i</mi><mi>n</mi><mtext> </mtext><mi>r</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>m</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mtext> </mtext><mi>i</mi><mi>s</mi><mtext> </mtext><mi>t</mi><mi>o</mi><mtext> </mtext><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mtext> </mtext><mi>b</mi><mi>y</mi><mtext> </mtext><mi>e</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>g</mi><mtext> </mtext><mi>t</mi><mi>h</mi><mi>e</mi><mtext> </mtext><mi>c</mi><mi>a</mi><mi>r</mi><mi>b</mi><mi>o</mi><mi>n</mi><mtext> </mtext><mi>f</mi><mi>o</mi><mi>o</mi><mi>t</mi><mi>p</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>t</mi><mtext> </mtext><mi>o</mi><mi>f</mi><mtext> </mtext><mi>A</mi><mi>I</mi><mtext> </mtext><mi>g</mi><mi>e</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mi>s</mi></mstyle></mrow><annotation encoding="application/x-tex">{\color{green}The \space main \space recommendation \space is \space to \space start \space by \space estimating \space the \space carbon \space footprint \space of \space AI \space generative \space models}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;color:green;">T</span><span class="mord mathnormal" style="color:green;">h</span><span class="mord mathnormal" style="color:green;">e</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">main</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">reco</span><span class="mord mathnormal" style="color:green;">mm</span><span class="mord mathnormal" style="color:green;">e</span><span class="mord mathnormal" style="color:green;">n</span><span class="mord mathnormal" style="color:green;">d</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">i</span><span class="mord mathnormal" style="color:green;">o</span><span class="mord mathnormal" style="color:green;">n</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">i</span><span class="mord mathnormal" style="color:green;">s</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">o</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">s</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="margin-right:0.02778em;color:green;">r</span><span class="mord mathnormal" style="color:green;">t</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">b</span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">y</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">es</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">ima</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">in</span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">g</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">h</span><span class="mord mathnormal" style="color:green;">e</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">c</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="margin-right:0.02778em;color:green;">r</span><span class="mord mathnormal" style="color:green;">b</span><span class="mord mathnormal" style="color:green;">o</span><span class="mord mathnormal" style="color:green;">n</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="margin-right:0.10764em;color:green;">f</span><span class="mord mathnormal" style="color:green;">oo</span><span class="mord mathnormal" style="color:green;">tp</span><span class="mord mathnormal" style="margin-right:0.02778em;color:green;">r</span><span class="mord mathnormal" style="color:green;">in</span><span class="mord mathnormal" style="color:green;">t</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">o</span><span class="mord mathnormal" style="margin-right:0.10764em;color:green;">f</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">A</span><span class="mord mathnormal" style="margin-right:0.07847em;color:green;">I</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">g</span><span class="mord mathnormal" style="color:green;">e</span><span class="mord mathnormal" style="color:green;">n</span><span class="mord mathnormal" style="margin-right:0.02778em;color:green;">er</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">i</span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">v</span><span class="mord mathnormal" style="color:green;">e</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">m</span><span class="mord mathnormal" style="color:green;">o</span><span class="mord mathnormal" style="color:green;">d</span><span class="mord mathnormal" style="color:green;">e</span><span class="mord mathnormal" style="margin-right:0.01968em;color:green;">l</span><span class="mord mathnormal" style="color:green;">s</span></span></span></span></span></span>

<p>There are no tools for estimating the total carbon footprint of the AI field. But the carbon footprint of a machine learning model can be estimated by the electricity consumption of the training procedure or inference. All software, from phone apps to cloud-based data science pipelines, consumes electricity. As not all electricity is generated from renewable sources, this consumption contributes to a carbon footprint.</p>

<p>Thanks to the Electricity Map tool <a href="https://app.electricitymaps.com/map">Link to the tool</a>, it’s possible to take action on the carbon footprint of codes. Electricity Maps is a 24/7 live visualization of where electricity comes from and how much CO2 is emitted to produce it. As a result, there’s enough information to determine in which country it’s best to locate servers.</p>

<p>Electricity production in France has very low CO2 emissions, largely thanks to its nuclear fleet and the development of renewable energies.</p>

<p>The carbon footprint of a machine learning model can be estimated by estimating the electricity consumption of the training procedure or inference. To obtain a carbon footprint estimate with this tool, simply enter the following parameters: Hardware type (GPU, CPU…), Number of hours the hardware was used, Cloud provider used, and Cloud region where the calculation took place (for example, “europe-north1”).</p>

<p>The measurement of a server’s power consumption is the sum of the power consumption of all its components. The first component is the measurement of CPU power consumption, performed by the RAPL interface on Unix operating systems or by Intel Power Gadget on Mac and Windows. The RAPL interface also provides RAM power consumption. The third component is the measurement of GPU power consumption, obtained via Nvidia SMI, which provides real-time power consumption via its interface or via Python (pyNVML).</p>

<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="green"><mi>C</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>C</mi><mi>a</mi><mi>r</mi><mi>b</mi><mi>o</mi><mi>n</mi><mo>:</mo><mtext> </mtext><mi>t</mi><mi>h</mi><mi>e</mi><mtext> </mtext><mi>e</mi><mi>s</mi><mi>s</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>a</mi><mi>l</mi><mtext> </mtext><mi>t</mi><mi>o</mi><mi>o</mi><mi>l</mi><mtext> </mtext><mi>f</mi><mi>o</mi><mi>r</mi><mtext> </mtext><mi>a</mi><mi>s</mi><mi>s</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>g</mi><mtext> </mtext><mi>t</mi><mi>h</mi><mi>e</mi><mtext> </mtext><mi>e</mi><mi>n</mi><mi>v</mi><mi>i</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>a</mi><mi>l</mi><mtext> </mtext><mi>i</mi><mi>m</mi><mi>p</mi><mi>a</mi><mi>c</mi><mi>t</mi><mtext> </mtext><mi>o</mi><mi>f</mi><mtext> </mtext><mi>g</mi><mi>e</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mtext> </mtext><mi>A</mi><mi>I</mi><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mi>s</mi></mstyle></mrow><annotation encoding="application/x-tex">{\color{green}CodeCarbon: \space the \space essential \space tool \space for \space assessing \space the \space environmental \space impact \space of \space generative \space AI \space models}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;color:green;">C</span><span class="mord mathnormal" style="color:green;">o</span><span class="mord mathnormal" style="color:green;">d</span><span class="mord mathnormal" style="color:green;">e</span><span class="mord mathnormal" style="margin-right:0.07153em;color:green;">C</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="margin-right:0.02778em;color:green;">r</span><span class="mord mathnormal" style="color:green;">b</span><span class="mord mathnormal" style="color:green;">o</span><span class="mord mathnormal" style="color:green;">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:green;">:</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">h</span><span class="mord mathnormal" style="color:green;">e</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">esse</span><span class="mord mathnormal" style="color:green;">n</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">ia</span><span class="mord mathnormal" style="margin-right:0.01968em;color:green;">l</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">oo</span><span class="mord mathnormal" style="margin-right:0.01968em;color:green;">l</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="margin-right:0.10764em;color:green;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;color:green;">or</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="color:green;">ssess</span><span class="mord mathnormal" style="color:green;">in</span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">g</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">h</span><span class="mord mathnormal" style="color:green;">e</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">e</span><span class="mord mathnormal" style="color:green;">n</span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">v</span><span class="mord mathnormal" style="color:green;">i</span><span class="mord mathnormal" style="color:green;">ro</span><span class="mord mathnormal" style="color:green;">nm</span><span class="mord mathnormal" style="color:green;">e</span><span class="mord mathnormal" style="color:green;">n</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="margin-right:0.01968em;color:green;">l</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">im</span><span class="mord mathnormal" style="color:green;">p</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="color:green;">c</span><span class="mord mathnormal" style="color:green;">t</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">o</span><span class="mord mathnormal" style="margin-right:0.10764em;color:green;">f</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">g</span><span class="mord mathnormal" style="color:green;">e</span><span class="mord mathnormal" style="color:green;">n</span><span class="mord mathnormal" style="margin-right:0.02778em;color:green;">er</span><span class="mord mathnormal" style="color:green;">a</span><span class="mord mathnormal" style="color:green;">t</span><span class="mord mathnormal" style="color:green;">i</span><span class="mord mathnormal" style="margin-right:0.03588em;color:green;">v</span><span class="mord mathnormal" style="color:green;">e</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">A</span><span class="mord mathnormal" style="margin-right:0.07847em;color:green;">I</span><span class="mspace" style="color:green;"><span style="color:green;"> </span></span><span class="mord mathnormal" style="color:green;">m</span><span class="mord mathnormal" style="color:green;">o</span><span class="mord mathnormal" style="color:green;">d</span><span class="mord mathnormal" style="color:green;">e</span><span class="mord mathnormal" style="margin-right:0.01968em;color:green;">l</span><span class="mord mathnormal" style="color:green;">s</span></span></span></span></span></span>

<p>There’s a tool that lets you make the estimate directly by integrating it into the code. CodeCarbon is an open-source Python package designed to estimate the carbon footprint of machine learning models and other applications. It takes into account hardware energy consumption, including GPU, CPU and RAM, as well as the carbon intensity of the computational region at fixed intervals, e.g. every 15 seconds. By monitoring energy consumption and multiplying by carbon intensity, CodeCarbon provides an estimate of the carbon dioxide equivalents (CO2e) used in a single run.</p>

<p>Integrating CodeCarbon with the inference code is relatively straightforward, as this script demonstrates:</p>

<p><code style="color : Green">tracker = EmissionsTracker()</code>
<code style="color : Green">tracker.start()</code></p>

<p><code style="color : Green">#code de l’inférence API pour appeler le modèle </code>
<code style="color : Green">#pour effectuer un l'inférence</code></p>

<p><code style="color : Green">model.predict(data)</code>
<code style="color : Green">emissions: float = tracker.stop()</code></p>

<p>CodeCarbon has a built-in log that records data in a CSV file named emissions.csv in the output directory, for each experiment tracked across projects. The most important features are emissions (emissions in CO₂ equivalents [CO₂eq], in kg), emissions_rate (emissions divided by time, in kg/s), cpu_power (processor power (W)), gpu_power (GPU power (W)), ram_power (RAM power (W)), energy_consumed (sum of cpu_energy, gpu_energy and ram_energy (kWh)), Country_name (name of the country where the infrastructure is hosted), etc.</p>

<p>CodeCarbon also comes with carbonboard, which provides a dashboard for data visualization. Users can understand the net energy consumption and emissions generated across projects, and can immerse themselves in a particular experiment or project.</p>

<p><img src="/assets/img/blog/footprintcarbon.png" alt="drawing" width="800" /></p>

<p>For an example of the Llama2 generative model, the model emitted an average of 0.0002kg of CO2 with the GPU environment. By repeating the experiment 100 times to make more inferences with the same model, 0.1kg of carbon equivalent were emitted (equivalent to 31 minutes of TV or 0.03% of weekly US household emissions). To put this into perspective, 1 h of visio, for two, with the camera emits 66 g CO2e on average in France. So much for the figures! Now it’s up to you to imagine the impact of our future Generative Models on our carbon footprint. Who would have thought that our discussions could carry such weight?</p>

